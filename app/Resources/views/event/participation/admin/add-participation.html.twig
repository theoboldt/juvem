{% extends 'base.html.twig' %}
{% import _self as m %}

{% block title %}Teilnahme erfassen ({{ event.title }}){% endblock %}

{% block body %}
    {% embed 'common/header/base-page-header.html.twig' with {'title': 'Anmeldung', 'subtitle': 'Teilnahme erfassen'} %}
        {% block breadcrumb %}
            <li><a href="{{ path('event_list') }}">Veranstaltungen</a></li>
            <li><a href="{{ path('event', {'eid': event.eid }) }}">{{ event.title }}</a></li>
            <li><a href="{{ path('event_participants_list', {'eid': event.eid }) }}">Teilnehmer</a></li>
            <li class="active">Teilnahme erfassen</li>
        {% endblock %}
    {% endembed %}
    <div class="container">
        {{ form_start(form) }}
        {% include '/event/participation/form-participation.html.twig' with {'form': form, 'acquisitionFields': acquisitionFieldsParticipation} %}
        {% embed 'event/admin/employee/embed-form-phone-numbers.html.twig' with {'formPhoneNumbers': form.phoneNumbers, 'labelAddNumber': 'Telefonnummer hinzufügen'} %}{% endembed %}

        <div class="row">
            <div class="col-xs-12">
                <h3>Teilnehmer</h3>
            </div>
        </div>
        {% macro prototypeParticipant(formElement, acquisitionFieldsParticipant) %}
            <div class="panel panel-default prototype-element">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-10 col-sm-8">
                            <h3 class="panel-title">
                                <!--<a role="button" data-toggle="collapse">-->
                                Teilnehmer
                                <!--</a>-->
                            </h3>
                        </div>
                        <div class="col-xs-2 col-sm-4 text-right">
                            <a href="#" class="btn btn-danger btn-xs prototype-remove"
                               title="Teilnehmer entfernen">{{ 'remove-sign'|glyph }}
                                <span class="hidden-xs">Teilnehmer entfernen</span>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="panel-body panel-collapse collapse in">
                    {% include '/event/participation/form-participant.html.twig' with {'form': formElement, 'acquisitionFields': acquisitionFieldsParticipant} %}
                </div>
            </div>
        {% endmacro %}

        <div class="row">
            <div class="col-xs-12 participants-list prototype-container"
                 data-prototype="{{ m.prototypeParticipant(form.participants.vars.prototype, acquisitionFieldsParticipant)|e('html_attr') }}">
                <div class="prototype-elements">
                    <div class="form-group">
                        {{ form_errors(form.participants) }}
                        {% for participant in form.participants %}
                            {{ m.prototypeParticipant(participant, acquisitionFieldsParticipant) }}
                        {% endfor %}
                        {% if form.participants|length == 0 %}
                            {{ form_row(form.participants) }}
                        {% endif %}
                        <div class="prototype-missing-message"{% if form.participants|length > 0 %} style="display:none"{% endif %}>
                            <div class="alert alert-danger">
                                <ul class="list-unstyled">
                                    <li><span class="glyphicon glyphicon-exclamation-sign"></span> Bei einer
                                        Anmeldung muss mindestens ein Teilnehmer angegeben werden. Bitte fügen
                                        Sie noch mindestens einen Teilnehmer hinzu.
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="btn btn-success prototype-add">{{ 'plus-sign'|glyph }} Weiteren Teilnehmer
                    hinzufügen
                </button>
            </div>
        </div>

        <div class="row">
            <div class="col-xs-12">
                <input type="submit" class="btn btn-primary navbar-btn" value="Teilnahme erfassen"/>
            </div>
        </div>
        {{ form_end(form) }}
    </div>

{% endblock %}
